+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 71.03344258712605 Prefill: 1.1655768658965826 Decode: 69.86786572122946
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 194.08788511762396 Prefill: 1.9209778881631792 Decode: 192.16690722946078
=================================================
Load the pre-trained pytorch weights of opt-30b from huggingface. The downloading and cpu loading can take dozens of minutes. If it seems to get stuck, you can monitor the progress by checking the memory usage of this process.
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 712.663210850209 Prefill: 4.956247430760413 Decode: 707.7069634194486
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + INT4
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 45.751748487353325 Prefill: 1.3153026616200805 Decode: 44.436445825733244
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + INT4
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 66.37822111649439 Prefill: 2.0477927210740745 Decode: 64.33042839542031
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + INT4
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 467.3525082222186 Prefill: 8.518036446999758 Decode: 458.83447177521884
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + H2O
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 25.192413923330605 Prefill: 0.9165267627686262 Decode: 24.27588716056198
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + H2O
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 39.52300081960857 Prefill: 1.5201903418637812 Decode: 38.00281047774479
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
FlexGen + H2O
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 401.33870286820456 Prefill: 5.350273763295263 Decode: 395.9884291049093
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
InfiniGen (Ours)
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 21.49630975164473 Prefill: 1.3997628609649837 Decode: 20.096546890679747
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
InfiniGen (Ours)
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 26.976682988461107 Prefill: 2.251764295157045 Decode: 24.724918693304062
=================================================
+++++++++++++++++++++++++++++++++++++++++++++++++
InfiniGen (Ours)
input: 1920 output: 128 bsz: 4
+++++++++++++++++++++++++++++++++++++++++++++++++
Total: 319.02825663844123 Prefill: 5.5836691851727664 Decode: 313.44458745326847
=================================================
